#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è DnD –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

echo "üéÆ DnD Game Deploy Script"
echo "========================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if [ ! -f "package.json" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: package.json –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è GitHub Pages –¥–µ–ø–ª–æ—è
deploy_github() {
    echo "üì¶ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ GitHub Pages..."
    
    # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
    echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
    npm run build
    
    if [ $? -ne 0 ]; then
        echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ø—Ä–æ–µ–∫—Ç–∞"
        exit 1
    fi
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Git –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
    if [ ! -d ".git" ]; then
        echo "üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git..."
        git init
    fi
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
    echo "üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ Git..."
    git add .
    
    # –ö–æ–º–º–∏—Ç
    echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞..."
    git commit -m "Deploy: $(date '+%Y-%m-%d %H:%M:%S')"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º remote
    if ! git remote get-url origin > /dev/null 2>&1; then
        echo "‚ö†Ô∏è  –£–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω."
        echo "–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"
        echo "git remote add origin https://github.com/YOUR_USERNAME/DND.git"
        exit 1
    fi
    
    # Push
    echo "üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ GitHub..."
    git push origin main
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
        echo "üåê –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø–æ –∞–¥—Ä–µ—Å—É:"
        echo "   https://YOUR_USERNAME.github.io/DND/"
    else
        echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ GitHub"
        exit 1
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è Vercel –¥–µ–ø–ª–æ—è
deploy_vercel() {
    echo "üì¶ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Vercel..."
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Vercel CLI
    if ! command -v vercel &> /dev/null; then
        echo "üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Vercel CLI..."
        npm install -g vercel
    fi
    
    # –î–µ–ø–ª–æ–π
    echo "üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Vercel..."
    vercel --prod
    
    echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è Netlify –¥–µ–ø–ª–æ—è
deploy_netlify() {
    echo "üì¶ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Netlify..."
    
    # –°–±–æ—Ä–∫–∞
    echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
    npm run build
    
    if [ $? -ne 0 ]; then
        echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ø—Ä–æ–µ–∫—Ç–∞"
        exit 1
    fi
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Netlify CLI
    if ! command -v netlify &> /dev/null; then
        echo "üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Netlify CLI..."
        npm install -g netlify-cli
    fi
    
    # –î–µ–ø–ª–æ–π
    echo "üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Netlify..."
    netlify deploy --prod --dir=dist
    
    echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
}

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
echo ""
echo "–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –¥–µ–ø–ª–æ—è:"
echo "1) GitHub Pages (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, —á–µ—Ä–µ–∑ Git)"
echo "2) Vercel (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ)"
echo "3) Netlify (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏)"
echo "4) –¢–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ (–±–µ–∑ –¥–µ–ø–ª–æ—è)"
echo ""

read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä (1-4): " choice

case $choice in
    1)
        deploy_github
        ;;
    2)
        deploy_vercel
        ;;
    3)
        deploy_netlify
        ;;
    4)
        echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
        npm run build
        echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –§–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ dist/"
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
        exit 1
        ;;
esac

echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –í–∞—à–µ DnD –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ!"
